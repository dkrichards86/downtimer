language: node_js
node_js:
  - "8.12.0"
cache:
  yarn: true
  directories:
  - node_modules

stages:
  - test
  - name: deploy
    if: branch = master

jobs:
  include:
    - stage: test
      script:
        - npm run lint
        - npm run test:unit

    - stage: deploy
      script:
        - npm run build
      deploy:
          provider: s3
          access_key_id:
            secure: "BdzRZ+6/9gU0D4vhLxjMQsELBXAMpOmHGh5/wOSkKKMhddLKWMOVeHg2JE7XO2mzq2WWPOcrVmV33yFhC476uF+HM1+PueUUFhchHT25HxytRTEYY0Mao+N4q3abwh0ATEBe3USVCYowarUUl/LBVlVgr3/SNFBx0vQtOnSH3bPPMs7AkTIvqJVQI01vJMusYsO6bMqYEYf1rly8+28WPdlqxYzE28xPBQTE8ihgxGXf+CzFeaTjNgARGENavu1cazYq6/Efe1oB8eEQhn/GQ5fAwheggoslxje5bVxX+3k9MPInBJ2orthLaPNoR+w9Do5dQXcu6bXK8ci0gqd7RiazekiW77wl1lAGOVeEDcurZ3hSlQzEzu+yF2nDb2bMcSuVdwZ0DAiOiBuNlTmCLezssw8PgzkoRqIH4n5PtwDVVr3Q+vOA7p1a30X6RurI1I8YnffhdqH3qe+0Ip0kllbikIFmzwCbhkrlEnuvF27y2Bsv1rvfXYMuqNHoUDQBmjJCDzUOkKEEIVOwEii3e2vFPIQQYh7QVhNwrquWJefntH1fnuqWk0gwwSkWjO2lGX8oA1GuxJvW2ovAjCILAZUdOO2RORiOBMMp6tsyyEoCKPWvjJi00Ks2/aslIGEQnyu7fMr4TGb+XQLNyj0NbqxpmRr+okYHIDFqrxR+5Lw="
          secret_access_key:
            secure: "Ce4dkgdehJaXDk53uVm+1DIcbqNmwwoE54xUbFtgU0KEL/NI7lfc3e6y3JnsSOadUiglD6X4wN1nyLkXw6Yswjr8lcQ8tYBtYy9rMQlDV+Wn3jzNYFz78g9Vw/kLZjSxd6AZax4GyZfQo2MRvVpivp4RCBIAXNF6FUCY5b03avpd4ddKrXZD5UVk37BSaEKeaKnigbc9T1mjEp3pYwsmiB3aGgWCCqP9gIJKr8ErMKbvweCqN5zq0GoszY4T6diOLaf+W9t0fYnxHuqxv0QNPTen67i9FVXj/O9ceH1vxInRER8XyY3hxSjyPhgQWUhSWt7Rfkw+qUX61lyPSWKYKyEK+kBzDFr4d33xCVt5511B84TeC0YaDiJEWh9I9+obUCMOaOjXb1aToC4Xe33B62HzXzzFvjDs1f6ZJb3wOzm2Yay6SpDWIv+4bKHVgN8wPxetuM/5waCS37itZrrunKOOu2caFGgeTXw7HFfShJTrCgzrR15CrtsYbu2DI5teG/k1i80C+SwyzCMYCAtAWnlVzifSVtdEB0X6fO9SSkwCpi2lUZYsrbl7ewYnYNislJ1z+S10DFXQDXNfkxmute2pF0dh+30vc1+MCoMKqRJfzkQhOYsGiTg/WTpl5bTfcMNOr7gWNmrd46qM0WGLkftjnYgSqacxRcfZjeP7Abc="
          bucket: downtimer.io
          region: us-east-1
          acl: public_read
          local_dir: dist
          skip_cleanup: true
          on:
            branch: master
